<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bildirim Testi</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
      background: #0f172a;
      color: #fff;
    }
    button {
      background: #10b981;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 5px;
    }
    button:hover {
      background: #059669;
    }
    .info {
      background: #1e293b;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <h1>ğŸ”” Bildirim Test SayfasÄ±</h1>
  
  <div class="info">
    <h3>NasÄ±l Ã‡alÄ±ÅŸÄ±yor?</h3>
    <ul>
      <li><strong>15 dakika Ã¶nce:</strong> "15 dakika kaldÄ±" bildirimi</li>
      <li><strong>10 dakika Ã¶nce:</strong> "10 dakika kaldÄ±" bildirimi</li>
      <li><strong>5 dakika Ã¶nce:</strong> "5 dakika kaldÄ±" bildirimi</li>
      <li><strong>Tam zamanÄ±nda:</strong> "Sahur Vakti!" / "Ä°ftar Vakti!" bildirimi + <strong>Ezan sesi Ã§alar</strong></li>
    </ul>
  </div>

  <h2>Test ButonlarÄ±</h2>
  
  <button onclick="testNotificationNow()">Åimdi Bildirim GÃ¶nder (Ezan ile)</button>
  <button onclick="testNotification15min()">15 Dakika Bildirimi Test</button>
  <button onclick="testAzanSound()">Sadece Ezan Sesi Test</button>
  <button onclick="requestPermission()">Bildirim Ä°zni Ä°ste</button>

  <div class="info">
    <h3>Durum:</h3>
    <p id="status">YÃ¼kleniyor...</p>
  </div>

  <script>
    // Check notification permission
    function updateStatus() {
      const statusEl = document.getElementById('status');
      if (!('Notification' in window)) {
        statusEl.textContent = 'âŒ Bu tarayÄ±cÄ± bildirimleri desteklemiyor';
        return;
      }
      
      const permission = Notification.permission;
      if (permission === 'granted') {
        statusEl.textContent = 'âœ… Bildirim izni verildi';
      } else if (permission === 'denied') {
        statusEl.textContent = 'âŒ Bildirim izni reddedildi';
      } else {
        statusEl.textContent = 'âš ï¸ Bildirim izni bekleniyor';
      }
    }

    function requestPermission() {
      if (!('Notification' in window)) {
        alert('Bu tarayÄ±cÄ± bildirimleri desteklemiyor');
        return;
      }
      
      Notification.requestPermission().then((permission) => {
        updateStatus();
        if (permission === 'granted') {
          alert('Bildirim izni verildi!');
        }
      });
    }

    function testNotificationNow() {
      if (Notification.permission !== 'granted') {
        alert('Ã–nce bildirim izni verin!');
        return;
      }

      // Show notification
      new Notification('Ä°ftar Vakti!', {
        body: 'Ä°ftar vakti geldi',
        icon: '/icon-192.png',
        badge: '/icon-192.png',
        tag: 'test-iftar-now',
      });

      // Play azan sound
      try {
        const audio = new Audio('/azan.mp3');
        audio.volume = 0.8;
        audio.play().catch((error) => {
          console.error('Ezan Ã§alma hatasÄ±:', error);
          alert('Ezan sesi Ã§alÄ±namadÄ±. TarayÄ±cÄ± ayarlarÄ±ndan ses izni verin.');
        });
      } catch (error) {
        console.error('Audio oluÅŸturma hatasÄ±:', error);
      }
    }

    function testNotification15min() {
      if (Notification.permission !== 'granted') {
        alert('Ã–nce bildirim izni verin!');
        return;
      }

      new Notification('15 dakika kaldÄ±', {
        body: '15 dakika sonra Ä°ftar vakti',
        icon: '/icon-192.png',
        badge: '/icon-192.png',
        tag: 'test-15min',
      });
    }

    function testAzanSound() {
      try {
        const audio = new Audio('/azan.mp3');
        audio.volume = 0.8;
        audio.play().catch((error) => {
          console.error('Ezan Ã§alma hatasÄ±:', error);
          alert('Ezan sesi Ã§alÄ±namadÄ±. TarayÄ±cÄ± ayarlarÄ±ndan ses izni verin.');
        });
      } catch (error) {
        console.error('Audio oluÅŸturma hatasÄ±:', error);
      }
    }

    // Initialize
    updateStatus();
  </script>
</body>
</html>
